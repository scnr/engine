<div class="panel-group">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" href="#<%= id %>-vector">
                    Vector information
                </a>
            </h4>
        </div>
        <div id="<%= id %>-vector">
            <div class="panel-body">
                <%= erb 'issue/vector.erb', id: id, vector: issue.vector %>
            </div>
        </div>
    </div>

    <div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
              Affected page:
              <code><%= escapeHTML(issue.page.dom.url) %></code>
            </h4>
        </div>
        <div id="<%= id %>-affected_page">
            <div class="panel-body">
                <%= erb 'issue/page.erb', id: "#{id}-affected_page",
                        page:  issue.page,
                        issue: issue
                %>
            </div>
        </div>
    </div>

    <% if issue.execution_flow && issue.execution_flow.points.any? %>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          Execution trace
        </h4>
      </div>
      <div id="<%= id %>-execution-trace">
        <div class="panel-body">
          <%= erb 'issue/execution_trace.erb', id: id, execution_flow: issue.execution_flow %>
        </div>
      </div>
    </div>
    <% end %>

  <% if issue.data_flow && issue.data_flow.sinks.any? %>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          Data flow
        </h4>
      </div>
      <div id="<%= id %>-data-flow">
        <div class="panel-body">
          <%= erb 'issue/data_flow.erb', id: id, data_flow: issue.data_flow %>
        </div>
      </div>
    </div>
  <% end %>

</div>
